module location-util

imports
  strategodebuglib


imports
  libstratego-lib
  include/Test


rules

  location-to-term :
    loc -> <r-exit(
            | "location-util.str"
            , "location-to-term"
            , LocationInfo("11", "2", "16", "50")
            )> term
    where r-enter(
          | "location-util.str"
          , "location-to-term"
          , LocationInfo("11", "2", "16", "50")
          )
    where <s-var(
           | "location-util.str"
           , "location-to-term"
           , "loc"
           , LocationInfo("12", "3", "12", "6")
           )> loc
    with (s-step(
          | "location-util.str"
          , "location-to-term"
          , LocationInfo("14", "4", "14", "33")
          )
          ; values := <s-step(
                       | "location-util.str"
                       , "location-to-term"
                       , LocationInfo("14", "15", "14", "28")
                       )
                       ; get-arguments> loc
          ; <s-var(
             | "location-util.str"
             , "location-to-term"
             , "values"
             , LocationInfo("14", "4", "14", "10")
             )> values)
         ; (s-step(
            | "location-util.str"
            , "location-to-term"
            , LocationInfo("15", "6", "15", "38")
            )
            ; args := <s-step(
                       | "location-util.str"
                       , "location-to-term"
                       , LocationInfo("15", "15", "15", "30")
                       )
                       ; map(
                           s-step(
                           | "location-util.str"
                           , "location-to-term"
                           , LocationInfo("15", "19", "15", "29")
                           )
                           ; create-arg
                         )> values
            ; <s-var(
               | "location-util.str"
               , "location-to-term"
               , "args"
               , LocationInfo("15", "6", "15", "10")
               )> args)
         ; s-step(
           | "location-util.str"
           , "location-to-term"
           , LocationInfo("16", "6", "16", "50")
           )
         ; term := NoAnnoList(Op("LocationInfo", args))
         ; <s-var(
            | "location-util.str"
            , "location-to-term"
            , "term"
            , LocationInfo("16", "6", "16", "10")
            )> term

  create-arg :
    a -> <r-exit(
          | "location-util.str"
          , "create-arg"
          , LocationInfo("19", "2", "20", "26")
          )> NoAnnoList(Str(a))
    where r-enter(
          | "location-util.str"
          , "create-arg"
          , LocationInfo("19", "2", "20", "26")
          )
    where <s-var(
           | "location-util.str"
           , "create-arg"
           , "a"
           , LocationInfo("20", "3", "20", "4")
           )> a